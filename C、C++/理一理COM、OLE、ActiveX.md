# 理一理COM、OLE、ActiveX

听了，学了，用了很多COM、OLE、ActiveX的技术，但是一直是一团模糊的概念，只知道这三样东西都是一路货色，但是具体有什么区别呢，没有去深究，今天心血来潮，上网查了一些资料，终于有点清楚了~~~

得到的结论就是：COM、OLE、ActiveX的的确确是一路货色！！！虽然说的有些武断，但我只是将人们对COM、OLE、ActiveX最广泛的理解表达出来，三者之间还是很大区别的，具体渊源后面讲。

## 一、组件（Component）和对象（Object）之间的区别。

网上找的：组件是一个可重用的模块，它是由一组处理过程、数据封装和用户接口组成的业务对象 （Rules Object）。组件看起来像对象，但不符合对象的学术定义。它们的主要区别是：
1）组件可以在另一个称为容器（有时也称为承载者或宿主）的应用程序中使用，也可以作为独立过程使用；
2）组件可以由一个类构成，也可以由多个类组成，或者是一个完整的应用程序；
3）组件为模块重用，而对象为代码重用。

以我自己理解，两者最大的区别就是第三点，前两个区别只能说是抽象的层次不一样，都是过程和数据的封装而已。或者换个说法更清楚：组件是编译好的程序的重用，对象是没编译的代码的重用！！呵呵，不知道这么说对不对，但是最起码好理解吧。


## 二、渊源

纯粹的数据交换（剪切板）有很多弊端，比如需要解析格式，无法同步数据等等，于是OLE出现了，对象的链接与嵌入（*Object Linking and Embedded，OLE*）的诞生把原来应用程序的数据交换提高到“对象交换”，这样程序间不但获得数据也同样获得彼此的应用程序对象，并且可以直接使用彼此的数据内容，其实OLE以前就是Microsoft的复合文档技术，它的最初版本只是瞄准复合文档。以我个人理解，OLE所谓的封装就是告诉调用者：我有哪些数据、什么程序可以操作这些数据。而其他程序只要使用OLE技术，就可以方便的获取数据，或者调用相应的程序操作数据。但是早期的OLE有自己的弊端，业界一直在抱怨它的缓慢和庞大，于是COM应运而生。

**COM**（Component Object Module，对象组件模型）的基本出发点是，让某个软件通过一个通用的机构为另一个软件提供服务。COM是应OLE的需求而诞生的，它的第一个使用者却是OLE2（新版OLE），所以虽然COM是OLE的基础，但OLE的产生却在COM之前。采用了COM技术的OLE，除了技术上可以让对象模型完全独立于编程语言之外，我自己认为最关键的一点就是：Microsoft借此“染指”通用平台技术。网上一句话说的很好：“可以将COM看作是某种（软件）打包技术”，其实COM就是如此工作的，通过COM就可以访问程序提供的功能，访问程序管理的数据。COM虽然起源于 复合文档，但却可有效地适用于许多软件问题，它毕竟是处在底层的基础技术。用一句话来说，COM是独立于语言的组件体系结构，可以让组件间相互通信。


COM并不是产品，它需要一个商标名称。而那时Microsoft的市场专家们已经选用了OLE作为商标名称，所以使用COM技术的都开始贴上了 OLE的标签。虽然这些技术中的绝大多数与复合文档没有关系。Microsoft 的这一做法让人产生这样一个误解OLE是仅指复合文档呢？还是不单单指复合文档？其实OLE是COM的商标名称，自然不仅仅指复合文档。而随着 Internet的发展，在1996年春，Microsoft改变了主意，选择ActiveX作为新的商标名称。ActiveX是指宽松定义的、基于COM的技术集合，而OLE仍然仅指复合文档。当然，ActiveX最核心的技术还是COM。ActiveX和 OLE的最大不同在于，OLE针对的是桌面上应用软件和文件之间的集成，而ActiveX则以提供进一步的网络应用与用户交互为主。

可以这么理解，**COM是个技术名词，是基础，OLE和ActiveX则是商标品牌，可以看做是基于COM技术开发的一种技术标准，且ActiveX是OLE的升级。**

尽管 ActiveX 和 OLE 都基于COM，但它们为程序员提供的却是截然不同的服务。COM提供的是低级的对象捆绑机制，该机制支持对象之间的交互通讯。OLE使用COM来提供低级的应用服务，例如采用连接和嵌入机制，支持用户创建复合文档。与之不同，ActiveX提供更精细的结构，用以支持在网络站点上嵌入控件，以及对事 件的交互反应。优化ActiveX，目的是为了提高时间和空间效率，而优化OLE，是为了便于终端用户的使用和集成台式系统的应用程序。

## 三、后缀名

ActiveX，OLE是基于COM的一种应用，其文件后缀一般以`dll`和`ocx`结尾；ocx作为一种特殊的dll文件，是有交互界面的可视化控件，定义了控件的属性和方法，定义控件可引发的事件的响应，我们通常说的.DLL为后缀名的文件是一个包含方法和数据的模块集合。文件扩展名为 .ocx的文件类型也是 DLL，尽管文件扩展名已改变。COM一般后缀名也是dll。






